
/* tracking.js 649ba6f */ if(!window.YAHOO){window.YAHOO={}}if(!YAHOO.Media){YAHOO.Media={}}YUI.add("media-tracking",function(a){YAHOO.Media.Tracking=function(c){var d=YAHOO.ULT,e=null;if(!d){return false}var b=function(g,l){var n=g.type,i=n&&e.conf.events[n]?e.conf.events[n][l.type]:false;if(i){var k=g.target,p=k.get("tagName").toLowerCase();for(var m in i){var o=i[m],h=o.node?o.node===p:true;if(!h&&o.bubbles){var j=k.ancestor(m);if(j!=null){k=j}p=k?k.get("tagName").toLowerCase():null;h=(p===o.node)}if(h&&k.hasClass(m)){if("test" in i[m]){var f={target:k};if("obj" in e){f.obj=e.obj}if(!i[m].test(f)){return}}this.beacon(this.evaluateData(o.data,k,g))}}}};this.init=function(f){if(f.conf){e=f;if("events" in e.conf){var g=e.conf.events;for(var h in g){if(g[h].hasOwnProperty(e.namespace)){this.track(e.el,h,{type:e.namespace})}}}}else{return false}};this.pageView=function(g,h){if(!this.iframe){this.iframe=a.Node.create('<iframe frameborder=0 height=0 width=0 title=""></iframe>');this.iframe.generateID();a.one(document.body).appendChild(this.iframe)}var f=new Date().getTime();g=g||e.pageView;g=g+(g.match("\\?")?"&":"?")+"ymgts="+f;this.iframe.set("src","javascript:document.location.replace('"+g+"');");if(h&&YAHOO.i13n&&YAHOO.i13n.sendComscoreEvent){var i=window.location.protocol+"//"+window.location.host+g;YAHOO.i13n.sendComscoreEvent({c7:i})}};this.track=function(g,h,f){if(a.Lang.isString(g)&&g.indexOf("#")!==0){g="#"+g}a.on(h,b,g,this,f)};this.evaluateData=function(l,m,p){var g={},i="callback",h,k,f;var j=a.Lang.isFunction(l)?l:false;if(j){k={target:m,event:p};if("obj" in e){k.obj=e.obj}var o=j(k);for(var q in o){g[q]=o[q]}}else{for(var n in l){if(l.hasOwnProperty(n)&&n!==i){h=a.Lang.isFunction(l[n])?l[n]:!l[n]&&a.Lang.isFunction(l[i])?l[i]:false;if(h){k={target:m,event:p,param:n};if("obj" in e){k.obj=e.obj}f=h(k)}else{f=l[n]}g[n]=this.normalize(f)}}}return g};this.normalize=function(f){return a.Lang.isString(f)?f.toLowerCase().replace(/[ \t\r\n\?'":]/g,"").substr(0,12):f};this.beacon=function(i){if(!i[YAHOO.ULT.SRC_SPACEID_KEY]){i[YAHOO.ULT.SRC_SPACEID_KEY]=e.conf.spaceid}if(YMedia.rapid){var f={},h={};f={sec:i.sec||"",linkname:i.slk||"",pos:i.pos||0};if(typeof i==="object"&&!i.keys){for(var g in i){if(g!=="sec"&&g!=="slk"&&g!=="pos"){h[g]=i[g]}}f.keys=h}a.Global.fire("rapid-tracker:click",{data:f})}else{if(YAHOO.ULT&&typeof YAHOO.ULT.beacon_click==="function"){YAHOO.ULT.beacon_click(i)}}};this.init(c)};YAHOO.Media.Tracking.prototype.iframe=null},"1.0",{requires:["node","event-base"]});