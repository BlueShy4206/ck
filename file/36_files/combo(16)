YUI.add("af-beacon",function(e,t){"use strict";function L(e,t){return Math.floor(Math.random()*(t-e+1))+e}function A(e,t,n){if(!e||!t||!n)return!1;var r=e+":"+t+":"+n;return w[r]?!0:(w[r]=!0,!1)}function O(t,n){var r=e.QueryString.stringify(t);if(r.length<=n)return r;var i=[],s=[],o=r.split("&");for(var u=0,a=o.length;u<a;u++){var f=o[u].split("="),l=f[0].charAt(0)==="_";l||m[f[0]]?i.push(o[u]):s.push(o[u])}i=i.join("&"),s=s.join("&");if(s){var c=n-i.length;s.length>c&&(s=s.substring(0,c),s?s+="&_trnc=1":s="_trnc=1")}var h=[];return i&&h.push(i),s&&h.push(s),h.join("&")}function M(t){return S=setInterval(function(){e.Af.Beacon._sendBatch()},t*1e3),S}function _(){clearTimeout(S),e.Af.Beacon._sendBatch()}function D(){if(x||!e.Af.Beacon.beaconPageLoadPerf)return;x=!0;var n,r,i,s=h.performance||h.webkitPerformance||h.msPerformance||h.mozPerformance||h.Performance||{},o={},u,a;s&&s.timing&&s.navigation?(u=s.navigation,a=s.timing,n=a.navigationStart,o={navT:u.type,navS:n,fetS:a.fetchStart-n,dluS:a.domainLookupStart-n,dluE:a.domainLookupEnd-n,conS:a.connectStart-n,conE:a.connectEnd-n,reqS:a.requestStart-n,resS:a.responseStart-n,resE:a.responseEnd-n,domL:a.domLoading-n,domI:a.domInteractive-n,domS:a.domContentLoadedEventStart-n,domE:a.domContentLoadedEventEnd-n,domC:a.domComplete-n,lodS:a.loadEventStart-n,lodE:a.loadEventEnd-n},a.linkNegotiationStart&&a.linkNegotiationEnd&&(o.lnkS=a.linkNegotiationStart-n,o.lnkE=a.linkNegotiationEnd-n),a.unloadEventStart&&(o.uldS=a.unloadEventStart-n,o.uldE=a.unloadEventEnd-n),a.redirectStart&&(o.redC=u.redirectCount,o.redS=a.redirectStart-n,o.redE=a.redirectEnd-n),typeof a.secureConnectionStart=="number"&&(o.secS=a.secureConnectionStart>0?Math.max(1,a.secureConnectionStart-n):0)):(n=h.afPerfHeadStart,r=h.afPerfPageEnd,i=h.afPerfPageLoad,n&&i&&(o.lodE=i-n),n&&r&&(o.pagE=r-n));if(!o.lodE)return;o.code="pageload",o.time=o.lodE,e.Af.Beacon.perf(t,o)}function P(){D(),_(),h.removeEventListener("unload",P,!1)}function H(){h.addEventListener("load",D,!1),h.addEventListener("unload",P,!1)}var n=300,r=2048,i=999,s="[object String]",o="[object Error]",u="[object Object]",a="error",f="info",l="perf",c="rt",h=window,p={once:!1},d={enable:!0,beaconUncaughtErr:!1,beaconPageLoadPerf:!1,pathPrefix:"/_td_api/beacon",sampleSize:1,batch:!0,batchInterval:5},v=["rid","bucket","device","site"],m={code:!0,src:!0,time:!0},g=["ActionScript","Decompress fail"],y=["^resource://"],b,w={},E=[],S,x=!1,T=e.merge(d,YUI.Env.Af&&YUI.Env.Af.settings&&YUI.Env.Af.settings.beacon,h.Af&&h.Af.config&&h.Af.config.beacon),N=e.merge(YUI.Env.Af&&YUI.Env.Af.settings&&YUI.Env.Af.settings.context,h.Af&&h.Af.context),C={os:e.UA&&e.UA.os},k;k={_sampled:{},_sampleSize:{},getKey:function(e){return e&&e.type&&e.src?e.type+":"+e.src:"default"},isSampled:function(t){var n=this,r=n.getKey(t);return e.Lang.isBoolean(n._sampled[r])?n._sampled[r]:n._sampled["default"]},setSize:function(e,t){var n=this,r=n.getKey(t);return e=parseInt(e,10),!isNaN(e)&&e!==n._sampleSize[r]&&(n._sampled[r]=e===1||e>0&&L(1,e)===1,n._sampleSize[r]=e),n._sampled[r]}},k.setSize(T.sampleSize),T.sampleSizeUncaughtErr&&k.setSize(T.sampleSizeUncaughtErr,{type:a,src:c}),e.Array.each(v,function(e){N[e]&&(C[e]=N[e]),m[e]=!0}),C=e.merge(C,T.meta||{}),e.namespace("Af").Beacon={enable_beaconrterr:T.beaconUncaughtErr,beaconPageLoadPerf:T.beaconPageLoadPerf,enable_batching:T.batch,batch_interval:T.batchInterval,meta:C,pathPrefix:T.pathPrefix,setSampleSize:function(e,t){return k.setSize(e,t)},isSampled:function(e){return k.isSampled(e)},_queryStringify:O,send:function(t,n,i){function u(e,t){e&&!o&&(o=!0,e(t))}if(!t){i&&i("invalid beacon path");return}var s=new Image,o;s.onerror=function(e){var t=e instanceof Error?e.toString():e;u(i,t)},s.onload=function(){u(i)};try{n&&e.Object.size(n)&&(n._rdn=(new Date).getTime().toString().substr(7),t+="?"+O(n,r)),s.src=t,i&&setTimeout(function(){u(i,"aborted")},4e3);return}catch(a){u(i,"path failed")}},_enqueue:function(e,t,n){E.push({beacon:{type:e,data:t},cb:n})},_dequeueAll:function(){return E.splice(0,E.length)},_sendBatch:function(){function t(e,t){var n,r=e.length;for(n=0;n<r;n++)e[n]&&e[n].cb&&e[n].cb(t);return}if(E.length===0)return;var n=this._dequeueAll(),r=this.pathPrefix+"/batch",i;try{i={method:"POST",timeout:4e3,data:e.JSON.stringify(n),headers:{"Content-Type":"application/json"},on:{success:function(e){t(n)},failure:function(e,r){t(n,r.status+":"+r.statusText)}}},e.io(r,i)}catch(s){t(n,"path failed")}},xhr:function(t,n,i){if(!t){i&&i("invalid xhr path");return}var s;n=n||{},s={method:"GET",timeout:n.timeout||2e3,headers:n.headers||{},on:{success:function(e,t){i&&i({statusCode:t.status})},failure:function(e,t){i&&i({statusCode:t.status,statusText:t.statusText,respText:t.responseText})}}};try{t+="?"+O(n.query,r),e.io(t,s)}catch(o){i&&i("querystring stringify failed")}},error:function(t,r,f,l){l=e.merge(p,l);var c=l.callback;if(!f){c&&c("missing error");return}var h=this.isSampled({type:a,src:t});if(!h||this._shouldIgnoreError(f)||l.once===!0&&f.code&&A(a,t,f.code)){c&&c();return}var d,v=Object.prototype.toString.call(f);if(f){switch(v){case s:d={code:i,message:f};break;case o:d={code:f.code||f.name||i,message:f.message,line:f.lineNumber||"",file:f.fileName||""};break;case u:d=f;break;default:try{d={code:i,message:e.JSON.stringify(f)}}catch(m){}}d.message=d.message&&d.message.substring(0,n)||""}this._send(a,t,e.merge(this.meta,r,d),c)},info:function(t,n,r){r=e.merge(p,r);var i=r.callback;if(!n||!n.code){i&&i("missing data.code");return}var s=this.isSampled({type:f,src:t});if(!s||r.once===!0&&A(f,t,n.code)){i&&i();return}this._send(f,t,e.merge(this.meta,n),i)},perf:function(t,n,r){r=e.merge(p,r);var i=r.callback;if(!n||!n.code||!e.Object.owns(n,"time")){i&&i("missing data.code or data.time");return}var s=this.isSampled({type:l,src:t});if(!s||r.once===!0&&A(l,t,n.code)){i&&i();return}this._send(l,t,e.merge(this.meta,n),i)},ignoreError:function(e){e&&g.push(e)},ignoreURL:function(e){e&&y.push(e)},_shouldIgnoreError
:function(e){if(!e)return!0;var t,n,r;typeof e=="string"?r=e:r=e.message;if(!r)return!1;for(t=0,n=g.length;t<n;t++)if(r.match(g[t]))return!0;return!1},_shouldIgnoreURL:function(e){if(!e)return!1;var t,n;for(t=0,n=y.length;t<n;t++)if(e.match(y[t]))return!0;return!1},_send:function(e,t,n,r){if(!T.enable){r&&r();return}var i=this,s=this.pathPrefix;if(!s){r&&r("no beacon pathPrefix");return}if(!e){r&&r("no beacon type");return}if(!n){r&&r("no beacon data");return}t&&(n.src=t),i.enable_batching?i._enqueue(e,n,r):i.send(s+"/"+e,n,r)}},b=h.onerror,h.onerror=function(r,i,s){var o=e.Af.Beacon,u;try{o.enable_beaconrterr&&!o._shouldIgnoreURL(i)&&(u={code:r.name,message:r.message||r,url:i&&i.substring(0,n),line:r.lineNumber||s||"",file:r.fileName||""},o.error(c,{},u))}catch(a){}return typeof b=="function"?b(r,i,s):!1},T.enable&&e.Af.Beacon.enable_batching&&M(e.Af.Beacon.batch_interval),h.addEventListener?(h.addEventListener("pageshow",H,!1),H()):h.attachEvent&&(h.attachEvent("onload",D),h.attachEvent("onunload",D),h.attachEvent("onunload",_))},"@VERSION@",{requires:["json-stringify","querystring-stringify-simple","io-base"]});
YUI.add("td-ads-feedback",function(e){"use strict";function a(){e.one("head").append('<style type="text/css">#Stencil .media-adfdb-btn:hover {display: block;}#Stencil .media-adfdb-btn-hide:hover {display: none;}.media-ad-feedback, .media-adfdb-btn, #media-adfeedback-btn {z-index:5;}.media-ad-feedback:after,.media-adfdb-btn:after,#media-adfeedback-btn:after {content: "";position: absolute;display: block;top: 100%;right: -5px;border-width: 0 5px 6px 5px;border-style: solid;border-color: transparent transparent transparent #333; }.media-ad-feedback:after{top: 36px; right: -8px;}.media-ad-feedback .ActionDislike a,.media-adfdb-btn .ActionDislike a,#media-adfeedback-btn .ActionDislike a {background: #abaeb7; border-color: #abaeb7; color: #fff}.media-ad-feedback, .media-ad-feedback input {background: #321c59}.media-ad-feedback .media-adfdb-options {display: block}.media-ad-feedback .media-adfdb-ty {display: none}.media-ad-feedback-ty .media-adfdb-options {display: none}.media-ad-feedback-ty .media-adfdb-ty {display: block}.media-ad-feedback-ty:after {display: none}.media-ad-feedback .media-fdb-undo {color: #8ec0ff}.media-ad-feedback .media-fdb-undo, .media-ad-feedback .Actions,.media-ad-feedback:after {display: none}</style>')}function f(t,n,r,i){var s="",o="";if(!t||!n)return;u[t]||(u[t]={movr_ad:!1,movr_x:!1,start:!1,submit:!1,undo:!1}),o+="type$fdb_"+n;if(u[t][n])return;r&&(o+=",subo$"+r),i?o+=",cmnt$"+escape(i):n==="submit"&&(o+=",cmnt$"),e.Media&&e.Media.pageChrome&&(s=e.Media.pageChrome.getBucketId()),u[t][n]=!0,t=t.replace(/\$\(AD_FEEDBACK\)/,"("+o+")"),e.Af.Beacon.send(t)}function l(e){var t=null,n;if(!i)return;n=e.target.ancestor(".media-ad-feedback"),n.all("input").each(function(e){e.get("checked")&&(t=e.get("value"))}),n.addClass("media-ad-feedback-ty"),f(i.getData("ad-feedback-beacon"),"submit",t,null)}function c(e){var t;e.halt(!0);if(!i)return;o&&(clearTimeout(o),o=null),t=e.target.ancestor(".media-ad-feedback"),t.addClass("D-n"),t.removeClass("media-ad-feedback-ty"),i.removeClass("V-h"),i.removeClass("D-n"),f(i.getData("ad-feedback-beacon"),"undo",null,null)}function h(e){if(!e||!s)return;var t=null,n=null,o,u;if(!e)return;o=e.get("offsetWidth"),u=e.get("offsetHeight");if(!e.one(".media-ad-feedback"))if(o>=350&&u>=160)e.append('<div class="media-adfdb-twocol media-ad-feedback FastTrans D-n Pos-a Cf C-w T-0 Start-0 W-100 H-100 V-v"><div class="media-adfdb-ty P-12"><h3 class="Fz-m Fw-b">'+r.THANKYOU+"</h3>"+'<div class="Fw-200 Mt-10"><span>'+r.REVIEW+'</span><a href="#" class="Mstart-4 media-fdb-undo D-n">'+r.UNDO+"</a></div></div>"+'<div class="media-adfdb-options P-12"><h3 class="Fz-m Fw-b">'+r.HEADING+"</h3>"+'<ul class="Cf Mt-10 Fw-200">'+'<li class="Mb-10 Fl-start W-50"><input type="radio" class="Bd-0 M-0 P-0" name="fd" value="1"/>'+'<span class="Pstart-4">'+r.FDB1+'</span></li><li class="Mb-10 Fl-start W-50">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="6"/><span class="Pstart-4">'+r.FDB2+'</span></li><li class="Mb-10 Fl-start W-50">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="4"/><span class="Pstart-4">'+r.FDB3+'</span></li><li class="Mb-10 Fl-start W-50">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="2"/><span class="Pstart-4">'+r.FDB4+"</span></li></ul>"+'<button class="Btn UserDone Pos-a Px-10 Py-4" style="right:12px;bottom:12px;">'+r.DONE+"</button>"+'<div class="Actions Pos-a" style="top:12px;right:-3px"><div class="ActionDislike Ta-c">'+'<a href="#" class="D-ib Fz-xs M-0" style="height:22px;width:22px;line-height:22px;">'+'<b aria-live="polite" class="Fw-n Whs-nw ActionTooltip">'+r.UNDO+'</b><i aria-hidden="true" class="Icon Zoom-1 W-a Va-m">&#xe009;</i></a></div></div>'+"</div></div>");else if(o>=200&&u>=140)e.append('<div class="media-adfdb-sngcol media-ad-feedback FastTrans D-n Pos-a Cf C-w T-0 Start-0 W-100 H-100 V-v"><div class="media-adfdb-ty P-12"><h3 class="Fz-m Fw-b">'+r.THANKYOU+"</h3>"+'<div class="Fw-200 Mt-10"><span>'+r.REVIEW+'</span><a href="#" class="Mstart-4 media-fdb-undo D-n">'+r.UNDO+"</a></div></div>"+'<div class="media-adfdb-options P-12"><h3 class="Fz-m Fw-b">'+r.HEADING+'</h3><ul class="Cf Mt-10 Fw-200"><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="1"/><span class="Pstart-4">'+r.FDB1+'</span></li><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="6"/>'+'<span class="Pstart-4">'+r.FDB2+'</span></li><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="4"/><span class="Pstart-4">'+r.FDB3+'</span></li><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="2"/>'+'<span class="Pstart-4">'+r.FDB4+"</span></li></ul>"+'<button class="Btn UserDone Pos-a Px-10 Py-4" style="right:12px;bottom:12px;">'+r.DONE+"</button>"+'<div class="Actions Pos-a" style="top:12px;right:-3px"><div class="ActionDislike Ta-c">'+'<a href="#" class="D-ib Fz-xs M-0" style="height:22px;width:22px;line-height:22px;">'+'<b aria-live="polite" class="Fw-n Whs-nw ActionTooltip">'+r.UNDO+'</b><i aria-hidden="true" class="Icon Zoom-1 W-a Va-m">&#xe009;</i></a></div></div>'+"</div></div>");else{var a=o?o-250:0;e.append('<div class="media-adfdb-pop media-ad-feedback FastTrans D-n Pos-a Cf C-w T-0 Start-0 V-v" style="height:180px;width:250px;left:'+a+'px;">'+'<div class="media-adfdb-ty P-12"><h3 class="Fz-m Fw-b">'+r.THANKYOU+"</h3>"+'<div class="Fw-200 Mt-10"><span>'+r.REVIEW+'</span><a href="#" class="Mstart-4 media-fdb-undo D-n">'+r.UNDO+"</a></div></div>"+'<div class="media-adfdb-options P-12"><h3 class="Fz-m Fw-b">'+r.HEADING+'</h3><ul class="Cf Mt-10 Fw-200">'+'<li class="Mb-6"><input type="radio" class="Bd-0 M-0 P-0" name="fd" value="1"/>'+'<span class="Pstart-4">'+r.FDB1+'</span></li><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="6"/>'+'<span class="Pstart-4">'+r.FDB2+'</span></li><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="4"/><span class="Pstart-4">'+r.FDB3+'</span></li><li class="Mb-6">'+'<input type="radio" class="Bd-0 M-0 P-0" name="fd" value="2"/>'+'<span class="Pstart-4">'+
r.FDB4+"</span></li></ul>"+'<button class="Btn UserDone Pos-a Px-10 Py-4" style="right:12px;bottom:12px;">'+r.DONE+"</button>"+'<div class="Actions Pos-a" style="top:12px;right:-3px"><div class="ActionDislike Ta-c">'+'<a href="#" class="D-ib Fz-xs M-0" style="height:22px;width:22px;line-height:22px;">'+'<b aria-live="polite" class="Fw-n Whs-nw ActionTooltip">'+r.UNDO+'</b><i aria-hidden="true" class="Icon Zoom-1 W-a Va-m">&#xe009;</i></a></div></div>'+"</div></div>")}return e.one(".media-adfdb-btn")||e.append('<div class="media-adfdb-btn Actions Pos-a D-n" style="top: 5px; right: -5px"><div class="ActionDislike Ta-c"><a href="#" class="D-ib Fz-xs M-0" style="height:22px;width:22px;line-height:22px;"><b aria-live="polite" class="Fw-n Whs-nw ActionTooltip">'+r.TOOLTIP+'</b><i aria-hidden="true" class="Icon Zoom-1 W-a Va-m">&#xe009;</i></a></div></div>'),t=e.one(".media-ad-feedback"),n=e.one(".media-adfdb-btn"),n.on("mouseover",function(e){if(!i)return;f(i.getData("ad-feedback-beacon"),"movr_x",null,null)}),n.one("a").on("click",function(e){var r=i;e.halt(!0);if(!i)return;n.hasClass("media-adfdb-btn-hide")||n.addClass("media-adfdb-btn-hide"),f(i.getData("ad-feedback-beacon"),"start",null,null),i.one("[data-ad-feedback-container]")&&(r=i.one("[data-ad-feedback-container]")),t.removeClass("D-n"),t.removeClass("media-ad-feedback-ty"),i.addClass("V-h")}),t.one(".UserDone").on("click",l),t.one(".ActionDislike a").on("click",c),t.one(".media-adfdb-ty a").on("click",c),!0}function p(t){if(!t||!s)return;e.all(t).each(function(e){if(e.getData("ad-feedback-beacon")&&!e.hasClass("media-native-ad")){e.addClass("media-native-ad");var t=e.one(".media-adfdb-btn");e.on("mouseover",function(n){i=e,t.removeClass("media-adfdb-btn-hide"),t.removeClass("D-n"),f(i.getData("ad-feedback-beacon"),"movr_ad",null,null)}),e.on("mouseout",function(e){t.hasClass("D-n")||t.addClass("D-n")})}})}function d(e){s=e;if(s)switch(s){case 1:case"1":s=!0;break;case 0:case"0":default:s=!1}s&&a()}var t={"en-US":{DONE:"Done",FDB1:"It's offensive to me",FDB2:"I keep seeing this",FDB3:"It's not relevant to me",FDB4:"Something else",HEADING:"Why don't you like this ad ?",REVIEW:"We'll review and make changes needed.",THANKYOU:"Thank you for your feedback",TOOLTIP:"I don't like this ad",UNDO:"Undo"}},n=e.one("html").getAttribute("lang"),r=t["en-US"],i=null,s=!1,o=null,u={};n&&t[n]&&(r=t[n]),e.namespace("Ads").Feedback={insertAdClose:p,setFeatureFlag:d,insertFeedbackMarkup:h}},"@VERSION@",{requires:["node-base","event-base","af-beacon"]});
YUI.add("td-ads-polyfill",function(){"undefined"==typeof Array.prototype.map&&(Array.prototype.map=function(e,t){var n;if(typeof e!="function")throw new TypeError;for(n=0;n<this.length;n+=1)t?e.apply(t,[this[n],n,this]):e(this[n],n,this);return this}),Function.prototype.bind||(Function.prototype.bind=function(e){"use strict";if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){return undefined},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i})},"@VERSION@");
YUI.add("td-ads-fetcher",function(e){"use strict";var t=function(){var t=this;return function(n){t.config=n||{},t.ads=t.config.prefetchAd||{},t.adsFetchInProgress={},t.adsClientReady=!1,t.eventQueue=[],t.registerEvents(),e.Ads.Feedback&&e.Ads.Feedback.setFeatureFlag&&e.Ads.Feedback.setFeatureFlag(t.config.enableAdFeedback)}};t.prototype={registerEvents:function(){var t=this;e.Global.on("ads:ready",function(){t.adsClientReady=!0}),e.Global.on("nativeads:fetch",t.addToEventQueue,t)},addToEventQueue:function(e){var t=this;if(!e||!e.callback)return;e.count=e.count||1,t.eventQueue.push(e),t.processEventQueue()},processEventQueue:function(){var t=this,n,r,i,s,o,u;for(n=0;n<t.eventQueue.length;n+=1){r=t.eventQueue[n],i=r.section||e.Object.keys(t.ads)[0],s=t.ads&&t.ads[i];if(!s||s.length<=0){if(!t.config.enableClientSideFetch)continue;if(t.adsFetchInProgress[i])continue;t.adsFetchInProgress[i]=!0;if(t.adsClientReady){t.clientSideFetch(r);continue}e.Global.on("ads:ready",t.clientSideFetch,t,i);continue}r.template!=="card"||r.count!==1&&r.count!=="1"?r.template!=="text"||r.count!==1&&r.count!=="1"?o=s.splice(0,Math.min(r.count,s.length)):(u=t.getAdsIndexWithImage(s,!1),o=s.splice(u,r.count)):(u=t.getAdsIndexWithImage(s,!0),u<0?o="":o=s.splice(u,r.count)),r.callback(o),t.eventQueue.splice(n,1),n-=1}},getAdsIndexWithImage:function(e,t){var n,r=e.length,i=0;t&&(i=-1);for(n=0;n<r;n++){if(t&&e[n].secHqImage)return n;if(!t&&!e[n].secHqImage)return n}return i},clientSideFetch:function(t){var n=this;e.Global.fire("ads:fetch",{callback:function(e,r){if(e){console.log(e);return}n.ads[t]=r,n.adsFetchInProgress[t]=!1,n.processEventQueue()},section:t,spaceid:n.config.spaceid,count:5,mock:n.config.mock})}},e.namespace("Ads").Fetcher=new t},"@VERSION@",{requires:["node-base","td-ads-feedback","td-ads-polyfill"]});
YUI.add("td-ads-rule",function(e){"use strict";var t=function(){this.backfillCounter=0};t.prototype={getAdNodes:function(t){return t.hasAttribute("data-ad-backfill")?new e.NodeList(t):t.all("[data-ad]")},attemptBackfill:function(){if(this.backfillCounter>0)return this.backfillCounter-=1,!0;var t,n;return t=e.one("[data-ad-backfill]"),t?(n=t.getData("ad-backfill"),t.removeAttribute("data-ad-backfill"),n?(n=parseInt(n,10),isNaN(n)?!1:(this.backfillCounter=n,this.backfillCounter<1?!1:(this.backfillCounter-=1,!0))):!1):!1},addAdAttrs:function(t){var n;n=t.getData("ad-add"),n=n&&e.JSON.parse(n)||"";if(!n)return;n["class"]!==undefined&&t.hasClass(n["class"])===!1&&t.addClass(n["class"]),typeof n._markup!="undefined"&&t.setHTML(t.getHTML+n._markup),t.removeAttribute("data-ad-add")},replaceAdAttrs:function(t,n,r){var i,s=[];i=t.getData("ad-replace"),i=i&&e.JSON.parse(i)||{},typeof r=="object"&&(i=e.merge(i,r));if(!i||i.length||!n)return;s=e.Object.keys(i),e.Array.each(s,function(e){var r=n[i[e]]||"";if(e==="_markup"){t.setHTML(r);return}if(!r)return;if(e==="src"){t.hasClass("lzbg")?t.setAttribute("style",'background-image:url("'+r+'")'):t.setAttribute("src",r);return}e==="href"&&(t.setAttribute("target","_blank"),t.setAttribute("rel","nofollow")),e==="data-thirdparty-beacons"&&r&&r.length>0&&(r=JSON.stringify(r)),t.setAttribute(e,r)}.bind(this)),t.removeAttribute("data-ad-replace")},removeAdAttrs:function(t){var n,r=[];n=t.getData("ad-remove"),n=n&&e.JSON.parse(n)||"";if(!n)return;r=e.Object.keys(n),e.Array.each(r,function(e){if(e==="_markup"){t.setHTML("");return}if(e==="class"){t.removeClass(n[e]);return}t.removeAttribute(e)}),t.removeAttribute("data-ad-remove")},addAdBeaconAttrs:function(e,t){var n={"data-beacon":"beacon","data-thirdparty-beacon":"imprTrackingUrl","data-thirdparty-beacons":"imprTrackingUrls","data-ad-feedback-beacon":"ad_feedback_beacon"};this.replaceAdAttrs(e,t,n)}},e.namespace("Ads").Rule=new t},"@VERSION@",{requires:["node-base","json-parse"]});
YUI.add("viewport",function(e){"use strict";e.namespace("Viewport").Base=function(e){this.configure(e)},e.Viewport.Base.prototype={_singletonInstance:null,_isInViewport:null,_onEnterViewport:null,_onExitViewport:null,win:window,pageVisibilityInfo:null,eventHandles:[],subscribers:[],timer:null,timerDelay:500,handle:null,configure:function(t){e.Viewport.Base.prototype._singletonInstance=this,t&&"object"==typeof t&&(undefined!==t.delay&&"number"==typeof t.delay&&0<t.delay&&(this.timerDelay=t.delay),undefined!==t.isInViewport&&"function"==typeof t.isInViewport&&(this._isInViewport=t.isInViewport),undefined!==t.onEnterViewport&&"function"==typeof t.onEnterViewport&&(this._onEnterViewport=t.onEnterViewport),undefined!==t.onExitViewport&&"function"==typeof t.onExitViewport&&(this._onExitViewport=t.onExitViewport)),this._isInViewport||(this._isInViewport=this.defaultIsInViewport),this.initEventListeners()},register:function(e,t,n){if(e.addEventListener){e.addEventListener(t,this.handle,n);return}if(e.attachEvent){e.attachEvent(t,this.handle);return}},initEventListeners:function(){this.handle=this.throttle.bind(this),this.pageVisibilityInfo=this.getPageVisibilityInfo(),typeof window.addEventListener!="undefined"?(window.addEventListener("scroll",this.handle,!1),window.addEventListener("resize",this.handle)):typeof window.attachEvent!="undefined"&&(window.attachEvent("onscroll",this.handle,!1),window.attachEvent("onresize",this.handle)),undefined!==this.pageVisibilityInfo.hidden?this.register(this.pageVisibilityInfo.element,this.pageVisibilityInfo.events[0],!1):(this.register(this.pageVisibilityInfo.element,this.pageVisibilityInfo.events[0],!1),this.register(this.pageVisibilityInfo.element,this.pageVisibilityInfo.events[1],!1)),typeof window.addEventListener!="undefined"?window.addEventListener("beforeunload",this.beforeunloadHandler.bind(this),!1):typeof window.attachEvent!="undefined"&&window.attachEvent("onbeforeunload",this.beforeunloadHandler.bind(this),!1)},updateEventListener:function(){var e,t,n,r=navigator.userAgent;if(r.match(/MSIE [67]./i))return;t=document.querySelectorAll(".overlay-tracker");for(e=0;e<t.length;e+=1)n=t[e],typeof n.addEventListener!="undefined"?n.addEventListener("scroll",this.handle,!1):typeof n.attachEvent!="undefined"&&n.attachEvent("onscroll",this.handle,!1),n.className=n.className.replace("overlay-tracker","")},getPageVisibilityInfo:function(){var e=this.win.document;return undefined!==e.hidden?{hidden:"hidden",events:["visibilitychange"],element:e}:undefined!==e.webkitHidden?{hidden:"webkitHidden",events:["webkitvisibilitychange"],element:e}:undefined!==e.mozHidden?{hidden:"mozHidden",events:["mozvisibilitychange"],element:e}:undefined!==e.msHidden?{hidden:"msHidden",events:["msvisibilitychange"],element:e}:undefined!==e.onfocusin?{events:["onfocusin","onfocusout"],element:e}:{events:["focus","blur"],element:this.win}},throttle:function(e){this.timer&&clearTimeout(this.timer),setTimeout(this.scrollHandler.bind(this,e.type),this.timerDelay)},scrollHandler:function(e){this.subscribers.map(function(t){this.singleNodeScrollHandler(t,e)},this)},beforeunloadHandler:function(e){this.scrollHandler(e.type)},singleNodeScrollHandler:function(e,t){var n,r,i;n=e.node,r=e.wasVisible,i=this.isNodeVisible(e,t),!r&&i&&e.onEnterViewport&&e.onEnterViewport(n),r&&!i&&e.onExitViewport&&e.onExitViewport(n),e.wasVisible=i},isNodeVisible:function(e,t){var n,r;if("beforeunload"===t)return!1;if(undefined!==this.pageVisibilityInfo.hidden){if(document[this.pageVisibilityInfo.hidden])return!1}else if("blur"===t||"focusout"===t)return!1;return n=e.node,r=e.isInViewport(n),r},subscribe:function(e){var t;if("object"!=typeof e||null===e)return;if(undefined===e.node||"object"!=typeof e.node)return;t={node:e.node,wasVisible:!1},e.hasOwnProperty("isInViewport")&&"function"==typeof e.isInViewport?t.isInViewport=e.isInViewport:this._isInViewport&&(t.isInViewport=this._isInViewport),e.hasOwnProperty("onEnterViewport")&&"function"==typeof e.onEnterViewport?t.onEnterViewport=e.onEnterViewport:this._onEnterViewport&&(t.onEnterViewport=this._onEnterViewport),e.hasOwnProperty("onExitViewport")&&"function"==typeof e.onExitViewport?t.onExitViewport=e.onExitViewport:this._onExitViewport&&(t.onExitViewport=this._onExitViewport),this.subscribers.push(t),this.updateEventListener(),this.singleNodeScrollHandler(t)},defaultIsInViewport:function(e){if(!e)return!1;var t=e.getBoundingClientRect(),n=parseInt(e.offsetHeight,10),r=e.style&&e.style.display,i=e.style&&e.style.visibility;return 0===n||"none"===r||"hidden"===i?!1:t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}}},"@VERSION@",{requires:["td-ads-polyfill"]});
YUI.add("td-ads-viewport-beacon",function(e){"use strict";var t=function(){var e=this;return function(t){if(!e.hasRequiredConfig(t))return;if(!e.initAdsViewport())return;t.customEvents&&t.container&&t.customEvents.map(function(n){e.viewport.register(t.container,n,!1)},e);if(!t.positions)return;t.positions=t.positions instanceof Array&&t.positions||[t.positions],t.positions.map(function(t){e.viewport.subscribe({node:t})},e)}};t.prototype={viewport:null,hasRequiredConfig:function(e){return undefined===e||"object"!=typeof e?!1:!0},initAdsViewport:function(){return e.Viewport.Base?this.viewport?!0:navigator.userAgent.match(/MSIE [67]./i)?!1:(this.viewport=new e.Viewport.Base({isInViewport:this.isInViewport.bind(this),onEnterViewport:this.onEnterViewport.bind(this),onExitViewport:this.onExitViewport.bind(this)}),this.viewport?!0:!1):!1},isInViewport:function(e){if(!e)return!1;var t=e.getBoundingClientRect(),n=parseInt(e.offsetHeight,10),r=e.style&&e.style.display,i=e.style&&e.style.visibility,s=t.right-t.left,o=t.bottom-t.top,u=window.innerHeight||document.documentElement.clientHeight,a=window.innerWidth||document.documentElement.clientWidth,f=t.top>=0&&Math.min(u,t.bottom)-t.top,l=t.left>=0&&Math.min(a,t.right)-t.left;return f=f||t.bottom,l=l||t.right,0>f||0>l||0===n||"none"===r||"hidden"===i?!1:l*f>=s*o/2},onEnterViewport:function(e){this.fireBeacon(e,"data-beacon"),this.fireBeacon(e,"data-thirdparty-beacons")||this.fireBeacon(e,"data-thirdparty-beacon")},onExitViewport:function(){},computeBeacon:function(e,t){if(e.indexOf("$(AD_POSN)")===-1)return e;var n,r,i,s,o=".yom-generic-listings-module";if(!t)return e.replace("$(AD_POSN)","0");s=document.querySelectorAll(o+" li"),r=s.length;for(n=0;n<r;n+=1)s[n]===t&&(i=n+1);return typeof i=="undefined"&&(i="0"),e.replace("$(AD_POSN)",encodeURIComponent("pp=m,pi="+i+",st=p"))},fireBeacon:function(e,t){var n=e.getAttribute(t);if(!n)return!1;if(t==="data-thirdparty-beacons"&&n.length>0){var r=JSON.parse(n);if(!(typeof r=="object"&&r.length>0))return!1;for(var i=0;i<r.length;i++){var s=this.computeBeacon(r[i],e,t);this.generateBeacon(s,e,t)}e.removeAttribute("data-thirdparty-beacon")}else n=this.computeBeacon(n,e,t),this.generateBeacon(n,e,t);return!0},generateBeacon:function(e,t,n){var r,i=new Image;try{i.src=e}catch(s){}r=t.getAttribute(n+"-fired"),r?t.setAttribute(n+"-fired",r+","+e):t.setAttribute(n+"-fired",e),t.removeAttribute(n)}},e.namespace("Viewport").AdsBeacon=new t},"@VERSION@",{requires:["viewport","td-ads-polyfill"]});
YUI.add("td-ads-enhancer",function(e){"use strict";var t="",n=function(){var e=this;return function(){e.initialize()}};n.prototype={initialize:function(){var t=this;e.Global.on("ads:enhance",t.enhance),t.enhance(e.one("body"),!0)},enhance:function(n){if(!n)return;var r=e.Ads.Rule.getAdNodes(n);r.each(function(n){var r=t,i=null,s=n.getData("ad"),o=n.getData("ad-count")||"1",u={};if(s==="backfill"&&!e.Ads.Rule.attemptBackfill())return;i=n.ancestor("[data-ad-section]",!0),i!==null&&(r=i.getData("ad-section")),u.section=r,u.count=o,u.template=s,u.callback=function(t){var r,i;r=t&&t[0]||[],console.log("NativeAd returned",r);if(r.length===0)return;if(!n.getDOMNode())return;e.Ads.Rule.removeAdAttrs(n),e.Ads.Rule.replaceAdAttrs(n,r),e.Ads.Rule.addAdAttrs(n,r),e.Ads.Rule.addAdBeaconAttrs(n,r),n.all("[data-ad-remove]").each(function(t){e.Ads.Rule.removeAdAttrs(t)}),n.all("[data-ad-replace]").each(function(t){e.Ads.Rule.replaceAdAttrs(t,r)}),n.all("[data-ad-add]").each(function(t){e.Ads.Rule.addAdAttrs(t,r)}),e.Viewport.AdsBeacon({positions:n._node,container:n._node}),i=n.getData("ad"),n.setAttribute("data-ad-enhanced",i),n.removeAttribute("data-ad"),e.Ads.Feedback&&e.Ads.Feedback.insertFeedbackMarkup&&e.Ads.Feedback.insertAdClose&&e.Ads.Feedback.insertFeedbackMarkup(n)&&e.Ads.Feedback.insertAdClose(n)},e.Global.fire("nativeads:fetch",u)})}},e.namespace("Ads").Enhance=new n},"@VERSION@",{requires:["node-base","event-base","td-ads-rule","td-ads-feedback","td-ads-viewport-beacon","af-beacon"]});
