webpackJsonp([24,39],{130:function(e,t,r){"use strict";function s(e){return i.inspect(e,{showHidden:!0,depth:null})}var i=r(279),n={1:"log",2:"fatal",3:"error",4:"warn",5:"info",6:"debug",7:"trace"};e.exports=function(e,t,r,a,o){var c=arguments.length<=5||void 0===arguments[5]?!0:arguments[5],h=arguments.length<=6||void 0===arguments[6]?!0:arguments[6],p=n[t],l=(new Error).stack.split("\n").splice(2,Number.MAX_VALUE).join("\n"),u="";return e&&p&&e[p]?(a=i.isArray(a)?a.join("\n"):a,u="at "+r+"\n=====START=====\nERROR MESSAGE: \n"+s(a)+"\n"+(c?"CONTEXT: \n"+s(o)+"\n":"")+(h?"TRACING STACK: \n"+l+"\n":"")+"=====END=====\n",void e[p](u)):void e.warn("Logger receive invalide arguments")}},687:function(e,t,r){"use strict";function s(e,t){var r;try{r=JSON.parse(e)}catch(s){console.dir(s),r=n(t)?{}:t}return r}var i=r(131),n=i.isUndefined;e.exports=s},1205:function(e,t,r){"use strict";var s=r(6)("HeaderV2:updateHeaderSearch");e.exports=function(e,t,r){t=t||{},s("updateHeaderSearch",t),e.dispatch("UPDATE_HEADER_SEARCH",t),r()}},1476:function(e,t,r){"use strict";function s(e){var t=[];return t=e.hasOwnProperty("itemsInfo")?i(e,["itemsInfo","items"],[]).filter(Boolean):Object.keys(e).filter(function(e){return new RegExp("^[0-9]+$").test(e)}).map(function(t){return{search_term:e[t].term,display_term:e[t].display_term}})}var i=r(8);e.exports=s},1477:function(e,t,r){"use strict";var s=r(28),i=r(6)("SearchStore"),n=r(8),a=r(87).merge,o=s({storeName:"SearchStore",handlers:{OPEN_SEARCH_SUCCESS:"_openSearch",OPEN_TRENDING_SUCCESS:"_openTrending",OPEN_TRENDING_FAILURE:"_updateSearchFail",UPDATE_SEARCH_SUCCESS:"_openSearch",UPDATE_SEARCH_FAILURE:"_updateSearchFail",UPDATE_PLACEHOLDER_FAILURE:"_setPlaceHolderDefaultText",USE_DEFAULT_PLACEHOLDER:"_setPlaceHolderDefaultText",UPDATE_HEADER_SEARCH:"_toggleSearch",LOAD_LOCAL_TRENDING:"_loadLocalTrending"},initialize:function(){this.state={currentSearchTerm:"",localTrendingTerms:[],searchAssistTerms:[],isSearchBoxFocused:!1,newMailCount:0,placeholderText:"",configs:{},ui:{}}},_openTrending:function(e){i("_openTrending",e),void 0!==e&&(this.state.localTrendingTerms=e)},_loadLocalTrending:function(e){i("_loadLocalTrending",this.state.localTrendingTerms),this.state.searchAssistTerms=this.state.localTrendingTerms,this.emitChange()},_openSearch:function(e){if(i("_openSearch",e),void 0!==e.config&&(this.state.ui=a(this.state.ui,e.config.ui)),(e.placeholderText||""===e.placeholderText)&&(this.state.placeholderText=e.placeholderText),(e.currentSearchTerm||""===e.currentSearchTerm)&&(this.state.currentSearchTerm=e.currentSearchTerm),void 0!==e.searchAssistTerms&&(this.state.searchAssistTerms=e.searchAssistTerms),void 0!==e.isSearchBoxFocused&&(this.state.isSearchBoxFocused=e.isSearchBoxFocused),void 0!==e.newMailCount){var t=n(this.state,["mailCount","maxCountDisplay"],99);this.state.newMailCount=e.newMailCount>t?t:e.newMailCount}this.emitChange()},_updateSearchFail:function(e){i("_updateSearchFail",e),this.emitChange()},_setPlaceHolderDefaultText:function(e){i("_setPlaceHolderDefaultText",e),(e.defaultText||""===e.defaultText)&&(this.state.placeholderText=e.defaultText)},_toggleSearch:function(e){i("_toggleSearch",e),void 0!==e.isSearchBoxFocused&&(this.state.isSearchBoxFocused=e.isSearchBoxFocused),void 0!==e.showSearchComponent&&(this.state.ui.showSearchComponent=e.showSearchComponent),this.emitChange()},getSearch:function(e){var t={currentSearchTerm:this.state.currentSearchTerm,searchAssistTerms:this.state.searchAssistTerms,isSearchBoxFocused:this.state.isSearchBoxFocused,placeholderText:this.state.placeholderText,newMailCount:this.state.newMailCount,ui:this.state.ui};return i("getSearch",t),t},dehydrate:function(){return this.state},rehydrate:function(e){this.state=e}});e.exports=o},1494:function(e,t,r){var s=r(1759);e.exports=function(e){if("string"==typeof e)return e;var t=(e.protocol||"http")+"://";return t+=e.host,t+=e.path,e.matrix&&(t+=";"+s(e.matrix,";",!0)),e.query&&(t+="?"+s(e.query,"&")),t}},1681:function(e,t,r){"use strict";var s=r(6)("Search:Action:fetchDefaultKeyword"),i=r(130),n=r(8);e.exports=function(e,t,r){return t=t||{},s("[fetchDefaultKeyword]",t),t.feedUrl?void e.service.read("DefaultKeywordService",t,function(a,o){if(!o||o.hasOwnProperty("error")){var c=n(o,["error","responseText"],"failed to fetch DefaultKeywordService");i(e.logger,3,"[Search.fetchDefaultKeyword.service.read]",a||{error:c},e.session.dimensions),t.error=c,e.dispatch("UPDATE_PLACEHOLDER_FAILURE",t)}s("[fetchDefaultKeyword]",t);var h=Object.keys(o).filter(function(e){return new RegExp("^[0-9]+$").test(e)}).map(function(e,t){return o[e].term});return h.length>0?(t.placeholderText=h[0],e.dispatch("UPDATE_SEARCH_SUCCESS",t)):e.dispatch("USE_DEFAULT_PLACEHOLDER",t),r&&r()}):(e.dispatch("USE_DEFAULT_PLACEHOLDER",t),r&&r())}},1682:function(e,t,r){"use strict";var s=r(1494),i=r(130),n=r(8),a=r(687),o=r(1476);e.exports=function(e,t,r){t=t||{},t.currentSearchTerm||(t.currentSearchTerm=""),void 0!==t.isSearchBoxFocused||(t.isSearchBoxFocused=!1);var c=t.componentProps.componentConfig.toJS()||{},h={currentSearchTerm:t.currentSearchTerm,isSearchBoxFocused:t.isSearchBoxFocused,config:c};if(!h.config&&t.config&&(h.config=t.config),e.dispatch("OPEN_SEARCH_START",h),e.dispatch("OPEN_SEARCH_SUCCESS",h),!c.trending||c.trending.updateAtClient)return r&&r();var p={treningNowUrl:s(c.trending)};e.service.read("TrendingService",p,function(t,s){if(!s||s.hasOwnProperty("error")){var c=n(s,["error","responseText"],"failed to fetch TrendingService");i(e.logger,3,"[Search.openSearch.service.read]",t||{error:c},e.session.dimensions),e.dispatch("OPEN_TRENDING_FAILURE",{error:c})}else{var h=a(s),p=o(h);e.dispatch("OPEN_TRENDING_SUCCESS",p)}return r&&r()})}},1683:function(e,t,r){"use strict";var s=r(6)("AbuSearchV2:updateSearch");e.exports=function(e,t,r){t=t||{},s("updateSearch",t),e.dispatch("UPDATE_SEARCH_SUCCESS",t),r()}},1684:function(e,t,r){"use strict";var s=r(6)("Search:Action:updateTrending"),i=r(130),n=r(8),a=r(687),o=r(1476);e.exports=function(e,t,r){return t=t||{},s("[Trending]",t),t.update?void e.service.read("TrendingService",t,function(c,h){if(s("[Trending]",h),!h||h.hasOwnProperty("error")){var p=n(h,["error","responseText"],"failed to fetch TrendingService");i(e.logger,3,"[Search.updateTrending.service.read]",c||{error:p},e.session.dimensions),e.dispatch("UPDATE_SEARCH_FAILURE",{error:p})}else{var l=a(h);t.searchAssistTerms=o(l),e.dispatch("UPDATE_SEARCH_SUCCESS",t)}return r&&r()}):(e.dispatch("LOAD_LOCAL_TRENDING",{}),r&&r())}},1685:function(e,t,r){"use strict";e.exports={controllerViews:{Search:r(1686)},stores:{SearchStore:r(1477)}}},1686:function(e,t,r){"use strict";var s=r(10),i=r(8),n=r(1735),a=r(12),o=r(1682),c=r(1),h=r(16),p=r(1477),l=r(13),u=r(1683),d=r(1494),m=r(1205),f=r(6)("TimeStamp:Search:components:Search"),g=r(1684),S=r(1681),C=r(27).I13nAnchor,x=r(687),T=function(e){return e&&void 0!==e.length?e.filter(function(e,t){return e.length>0}).map(function(e,t){return e.toString()}).join("-"):!1},E=function(e,t){t=t||{enableHistory:!0},"string"==typeof e&&(t.enableHistory?window.location=e:window.location.replace(e))},y=c.createClass({displayName:"SearchBox",mixins:[h,l],fetchGossip:function(e){if(""===e){var t=a({},this.props.trending);this.executeAction(g,{treningNowUrl:d(t),update:this.props.trending.updateAtClient})}else{var r=a({},this.props.gossip);r.query={output:"jsonp",command:e||""},n(d(r),{prefix:"gossip"},function(e,t){var r=i(t,["gossip","results"],[]);this.executeAction(u,{searchAssistTerms:r.map(function(e){return{search_term:e.key,display_term:e.key}}).filter(Boolean)})}.bind(this))}},fetchKeyword:function(){var e=a({},this.props.popularSearch);this.executeAction(S,{feedUrl:this.props.ui.enableTrendingPlaceholder?d(e):null,defaultText:this.getIntlMessage("SEARCH_PLACEHOLDER")})},handleSearchTermFocus:function(){this.executeAction(u,{isSearchBoxFocused:!0})},handleSearchTermBlur:function(){this.executeAction(u,{isSearchBoxFocused:!1,showHeaderComponent:!0})},handleSearchTermChange:function(e){this.executeAction(u,{currentSearchTerm:e.target.value})},handleCloseButtonClick:function(){"509"!==this.props.bucket&&""===c.findDOMNode(this.refs.searchTerm).value?(this.handleSearchTermBlur(),this.props.ui.toggleHideSearchComponent&&this.executeAction(m,{showHeaderComponent:!0,showSearchComponent:!1})):(this.executeAction(u,{currentSearchTerm:"",isSearchBoxFocused:!0}),this.updateSearchTerm(""))},handleCloseTextClick:function(){this.handleSearchTermBlur(),this.props.ui.toggleHideSearchComponent&&this.executeAction(m,{showHeaderComponent:!0,showSearchComponent:!1}),this.executeAction(u,{currentSearchTerm:"",isSearchBoxFocused:!1}),this.updateSearchTerm("")},handleSubmitButtonClick:function(){var e={elm:"srch",itc:0},t=this.props.isHomePage?"srch":"srch-cp";this.props.i13n.executeEvent("beacon",{beaconType:"beaconClick",arguments:[t,"srchweb",0,e]});var r=c.findDOMNode(this.refs.searchTerm),s=r.value;!this.props.focus&&this.props.ui.enableTrendingPlaceholder&&r.placeholder!==this.getIntlMessage("SEARCH_PLACEHOLDER")&&(s=r.placeholder);var i=T([this.props.tsrcConfig.prefix,this.props.tsrcConfig.pageSrc,"sb",this.props.tsrcConfig.bucket]),n=a({},this.props.srp);n.query={p:s,".tsrc":i},E(d(n))},handleSearchSubmit:function(e){e.preventDefault();var t={elm:"srch",itc:0},r=this.props.isHomePage?"srch":"srch-cp";this.props.i13n.executeEvent("beacon",{beaconType:"beaconClick",arguments:[r,"srchwebent",0,t]});var s=c.findDOMNode(this.refs.searchTerm).value,i=T([this.props.tsrcConfig.prefix,this.props.tsrcConfig.pageSrc,"sb",this.props.tsrcConfig.bucket]),n=a({},this.props.srp);n.query={p:s,".tsrc":i},E(d(n))},updateSearchTerm:function(e){c.findDOMNode(this.refs.searchTerm).value=e},componentDidMount:function(){this.updateSearchTerm(""),this.fetchGossip(""),this.fetchKeyword()},componentWillUpdate:function(e,t){e.searchTerm!==this.props.searchTerm&&this.fetchGossip(e.searchTerm.trim()),e.focus&&c.findDOMNode(this.refs.searchTerm).focus()},render:function(){var e,t,r=s("search-box H(34px) Bdrs(1px)",{"Mend(43px)":this.props.focus}),i=s("search-input O(0) D(ib) Bdrs(0) M(0) Bd(0) H(100%) W(100%)",{"search-input-default C(#262626) Pstart(10px)":"509"!==this.props.bucket,"search-input-bucket509 C(#fff) Bgc(t) Pstart(25px) Pb(10px) Bxsh(n)":"509"===this.props.bucket,"Fz(18px)":this.props.focus,"Fz(15px)":!this.props.focus}),n=s(" D(ib) Ta(c) Va(t) Cur(p) Us(n)",{"Bgc(#fff) C(#a6a9b2) H(34px) W(35px) Lh(34px) End(44px) Fl(right) Fz(13px)":"509"!==this.props.bucket,"search-close-icon-bucket509 C(#fff) H(20px) W(20px) Lh(20px) T(0) B(0) End(0) Mend(43px) My(a) Bdrs(100%) Fw(b) Pos(a) Fz(9px)":"509"===this.props.bucket});this.props.focus&&(t=c.createElement("div",{className:n,onClick:this.handleCloseButtonClick},c.createElement("i",{className:"Icon IconClose"})),"509"===this.props.bucket?t=c.createElement("div",null,c.createElement("div",{className:n,onClick:this.handleCloseButtonClick},c.createElement("i",{className:"Icon IconClose"})),c.createElement("div",{className:"D(ib) Ta(c) Lh(35px) Cur(p) Us(n) End(0) C(#fff) Fz(15px) Pos(a)",onClick:this.handleCloseTextClick},"取消")):e=c.createElement(b,{searchAssistTerms:this.props.searchAssistTerms,searchAssistMaxLength:this.props.ui.searchAssistMaxLength,searchTermRef:this.refs.searchTerm,searchWrapRef:this.props.searchWrapRef,srp:this.props.srp,showNearby:this.props.ui.showNearbyEntry,nearbyEntry:this.props.nearbyEntry,tsrcConfig:this.props.tsrcConfig,searchTerm:this.props.searchTerm,i13n:this.props.i13n,isHomePage:this.props.isHomePage}));var a=c.createElement("div",{className:r},c.createElement("div",{className:"Pos(a) End(0)"},t,c.createElement("div",{className:"Bgc(#0f69ff) C(#fff) H(35px) W(44px) Lh(35px) End(0) D(ib) Ta(c) Va(m) Cur(p) Us(n) Bxz(bb) Fl(right)",onClick:this.handleSubmitButtonClick},c.createElement("i",{className:"Icon IconSearch Fz(18px)"}))),c.createElement("input",{className:i,type:"search",ref:"searchTerm",placeholder:this.props.focus?"":this.props.placeholderText,defaultValue:this.props.searchTerm,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",onInput:this.handleSearchTermChange,onFocus:this.handleSearchTermFocus,onBlur:this.handleSearchTermBlur}),e);return"509"===this.props.bucket&&(a=c.createElement("div",{className:r},c.createElement("div",{className:"H(34px) Bgc(t) D(ib) Cur(p) Us(n) C(#fff) Bxz(bb) Pb(10px) Lh(28px) Pos(a)",onClick:this.handleSubmitButtonClick},c.createElement("i",{className:"Icon IconSearch Fz-l"})),t,c.createElement("input",{className:i,type:"search",ref:"searchTerm",placeholder:this.props.focus?"":this.props.placeholderText,defaultValue:this.props.searchTerm,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",onInput:this.handleSearchTermChange,onFocus:this.handleSearchTermFocus,onBlur:this.handleSearchTermBlur}))),c.createElement("form",{className:"D(ib) Pos(r) Z(7) W(100%)",ref:"searchForm",action:"",onSubmit:this.handleSearchSubmit},a)}}),b=c.createClass({displayName:"SearchTray",render:function(){var e=this.props.searchAssistTerms.map(function(e,t){return c.createElement(v,{key:t,term:e,searchWrapRef:this.props.searchWrapRef,srp:this.props.srp,tsrcConfig:this.props.tsrcConfig,searchTerm:this.props.searchTerm,bucket:this.props.bucket,i13n:this.props.i13n,isHomePage:this.props.isHomePage,nearbyEntry:this.props.nearbyEntry,isNearbyEntry:!1})},this).slice(0,this.props.searchAssistMaxLength);if(this.props.showNearby&&""===this.props.searchTerm){var t={search_term:this.props.nearbyEntry.searchTerm,display_term:this.props.nearbyEntry.displayTerm},r=c.createElement(v,{term:t,searchWrapRef:this.props.searchWrapRef,srp:this.props.srp,tsrcConfig:this.props.tsrcConfig,searchTerm:this.props.searchTerm,bucket:this.props.bucket,i13n:this.props.i13n,isHomePage:this.props.isHomePage,nearbyEntry:this.props.nearbyEntry,isNearbyEntry:!0});e.unshift(r)}var s=c.createElement("table",{className:"search-tray C(#262626) Bdc(#dedede) My(1px) Pos(a) W(100%) Bd(1px)"},c.createElement("tbody",null,e));return"509"===this.props.bucket&&(s=c.createElement("div",{className:"search-tray Pos(a) W(100%)"},e)),s}}),v=c.createClass({displayName:"SearchTrayItem",mixins:[l],contextTypes:{session:c.PropTypes.object.isRequired},isSearchAssist:!0,srpConfig:{},checkPermission:function(e){var t=/iPad|iPhone|iPod/.test(navigator.platform),r=this.props.nearbyEntry.askPermissionText;if(!t)if("localStorage"in window&&null!==window.localStorage){var s=x(window.localStorage.getItem("Search.Nearby"))||{},n=i(s,["agreedTerms"],!1);if(!n&&(s.agreedTerms=window.confirm(r),window.localStorage.setItem("Search.Nearby",JSON.stringify(s)),!s.agreedTerms))return void E(d(this.srpConfig))}else window.alert(r);e()},getGeoLocation:function(e){var t=a({},i(this.props,["nearbyEntry","geoLocation"],{})),r=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){r.srpConfig.query.lat=i(t,["coords","latitude"],""),r.srpConfig.query.lon=i(t,["coords","longitude"],""),r.srpConfig.query.radius=i(t,["coords","accuracy"],""),r.srpConfig.query.lat&&r.srpConfig.query.lon&&(r.srpConfig.query.locupdate=1),e(d(r.srpConfig))},function(t){e(d(r.srpConfig))},t):e(d(r.srpConfig))},handleTermClick:function(){this.executeAction(u,{currentSearchTerm:this.props.term.display_term,isSearchBoxFocused:!1}),this.updateSearchTerm(this.props.term.display_term);var e={subsec:this.isSearchAssist?"sb-tray":"trend",elm:this.isSearchAssist?"srchast":"srctrend",itc:0},t=this.props.isHomePage?"srch":"srch-cp",r=this.isSearchAssist?"srchast":"srchtreweb";this.props.i13n.executeEvent("beacon",{beaconType:"beaconClick",arguments:[t,r,0,e]});var s=T([this.props.tsrcConfig.prefix,this.props.tsrcConfig.pageSrc,this.isSearchAssist?"sa":"tn",this.props.tsrcConfig.bucket]);this.srpConfig=a({},this.props.srp),this.srpConfig.query={p:this.props.term.search_term,".tsrc":s};var i=this;this.props.isNearbyEntry?this.checkPermission(function(){i.getGeoLocation(function(e){E(e)})}):E(d(this.srpConfig))},handleIconClick:function(){this.executeAction(u,{currentSearchTerm:this.props.term.display_term+" ",isSearchBoxFocused:!0}),this.updateSearchTerm(this.props.term.display_term+" ")},updateSearchTerm:function(e){this.props.searchWrapRef&&(c.findDOMNode(this.props.searchWrapRef).querySelector(".search-input").value=e)},render:function(){var e=i(this.context,["session","dimensions","region"],""),t="HK"===e?"C(#cc3333)":"C(#178817)",r=this.props.term.display_term,s=this.props.searchTerm.trim();if(this.isSearchAssist=!!s,this.isSearchAssist){var n=/[-\/\\^$*+?.()|[\]{}]/g,a=s.replace(n,"\\$&");r=r.replace(new RegExp(a,"gi"),'<span class="'+t+'">$&</span>')}var o=c.createElement("tr",{className:"Bxz(bb) Bdw(0) Bdbw(1px) Bds(s)"},c.createElement("td",{className:"Maw(0px) Pstart(10px) Py(12px) Lh(1) Va(m) Fz(18px) Us(n) Cur(p) Bgc(#fff) Ell",onClick:this.handleTermClick,dangerouslySetInnerHTML:{__html:r}}),c.createElement("td",{className:"W(44px) Bd-start Bxz(bb) Va(m) Ta(c) Us(n) Pt(12px) Pb(10px) Bgc(#f5f5f5) Cur(p)",onClick:this.handleIconClick},c.createElement("i",{className:"Icon IconLeftTop Fz(13px) C(#8d919d)"})));if(this.props.isNearbyEntry){var h=c.createElement("span",{className:"nearby-icon D(ib) W(12px) H(18px) Bgz(cv) Bgr(Nr) Va(b) Mstart(8px)"}),p=c.createElement("span",{className:"nearby-text Va(b) C(#0f69ff)"},this.props.nearbyEntry.displayTerm);o="509"===this.props.bucket?c.createElement("div",{className:"Bgc(#fff) H(47px) Pos(r)"},c.createElement("div",{className:"Bgc(t) H(100%) Mstart(36px) Mend(12px) Py(16px) Fz(15px) Bdbw(t) Bdbs(s) Bdbc(#d9d9d9) C(#5f5f5f) Bxz(bb) Us(n) Cur(p) Ell",onClick:this.handleTermClick},p,h)):c.createElement("tr",{className:"Bxz(bb) Bdw(0) Bdbw(1px) Bds(s)"},c.createElement("td",{className:"Maw(0px) Pstart(10px) Py(12px) Lh(1) Fz(18px) Us(n) Cur(p) Bgc(#fff) Ell",onClick:this.handleTermClick,colSpan:"2"},p,h))}return this.props.isNearbyEntry||"509"!==this.props.bucket||(o=c.createElement("div",{className:"Bgc(#fff) H(47px) Pos(r)"},c.createElement("div",{className:"Bgc(t) H(100%) Ta(c) Us(n) Cur(p) Pos(a) End(12px) Lh(47px)",onClick:this.handleIconClick},c.createElement("i",{className:"Icon IconLeftTop Fz(15px) C(#8d919d)"})),c.createElement("div",{className:"Bgc(t) H(100%) Mstart(36px) Mend(12px) Py(16px) Fz(15px) Bdbw(t) Bdbs(s) Bdbc(#d9d9d9) C(#5f5f5f) Bxz(bb) Us(n) Cur(p) Ell",dangerouslySetInnerHTML:{__html:r},onClick:this.handleTermClick}))),o}}),A=c.createClass({displayName:"MailButton",mixins:[l],getDefaultProps:function(){return{i13nKeys:{sec:"hd",slk:"",t1:"a1",t2:"hd",t3:"mail-mu",elm:"",outcome:"",itc:0}}},fetchMailCount:function(){var e=a({},i(this.props,["mailCount","api"]),{}),t=this.getStore("HighlanderAppStore").getYck();e.query={appid:"Highlander",output:"jsonp",wssid:t.wssid},n(d(e),{prefix:"mailCount"},function(e,t){var r=i(t,["newmailcount"],"0");this.executeAction(u,{newMailCount:parseInt(r,10)})}.bind(this))},componentDidMount:function(){var e=1e3*i(this.props,["mailCount","refreshInterval"],0),t=this.getStore("UserStore").isSignedIn();t&&(this.fetchMailCount(),e>0&&(this.timer=setInterval(this.fetchMailCount,e)))},componentWillUnmount:function(){clearInterval(this.timer)},deepLink:function(){if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)){if(/(CriOS)/i.test(navigator.userAgent))return;var e=document.createElement("iframe");e.setAttribute("src","ymail-asdk://mail"),e.setAttribute("width","1px"),e.setAttribute("height","1px"),e.setAttribute("position","absolute"),e.setAttribute("top","0"),e.setAttribute("left","0"),document.documentElement.appendChild(e),e.parentNode.removeChild(e),e=null}else if(/(Chrome)/i.test(navigator.userAgent)){var t=navigator.userAgent.match(/Chrome\/([\d]+)/),r=parseInt(t&&t[1]);if(40>r)return;E("ymail://mail")}},render:function(){var e=i(this.props,["mailCount","url"],"#"),t=this.props.newMailCount>0?c.createElement("span",{className:"mail-alert Bgc(#ed3729) W(20px) Pos(a) D(ib) Bxz(bb) Fw(b) Lh(1.4) Pt(1px) Pb(2px) T(0) End(0) Ta(c) C(#fff) Fz(11px) Bdrs(100px)"},this.props.newMailCount):null,r=this.getStore("UserStore").isSignedIn(),s=a({},this.props.i13nKeys,{slk:r?"mailsigninst":"mailsignost",elm:r?"lgn":"lgo",outcome:r?"lgn":"lgo"});return c.createElement(C,{href:e,onClick:this.deepLink,i13nModel:s},c.createElement("div",{className:"D(ib) Ta(c) Us(n) Bxz(bb) Pos(a) Cur(p) End(10px)",ref:"mailButton"},c.createElement("i",{className:"Icon IconMail C(#fff) Fz(26px) H(35px) Lh(35px)"}),t))}}),P=c.createClass({displayName:"Search",mixins:[l,h],statics:{initializeAction:o,storeListeners:[p],componentConfig:{name:"componentSearch"}},contextTypes:{session:c.PropTypes.object.isRequired},isHomePage:!1,getInitialState:function(){var e=this.props.componentConfig.toJS()||{};return this.isHomePage=e.ui.showSearchComponent||!1,{ui:i(e,["ui"],{}),srp:i(e,["srp"],{}),trending:i(e,["trending"],{}),gossip:i(e,["gossip"],{}),mailCount:i(e,["mailCount"],{}),nearbyEntry:i(e,["nearbyEntry"],{}),popularSearch:i(e,["popularSearch"],{}),placeholderText:this.getIntlMessage("SEARCH_PLACEHOLDER"),currentSearchTerm:""}},onChange:function(){this.setState(this._getStoreData())},render:function(){if(f("search render"),this.state.ui&&!this.state.ui.showSearchComponent)return null;var e=c.createElement(A,{context:this.props.context,mailCount:this.state.mailCount,newMailCount:this.state.newMailCount}),t=!this.state.ui.showMailIcon||this.state.isSearchBoxFocused,r=i(this.state,["ui","fixedTop"],!1),n=i(this.state,["ui","placeholderHeight"],0),a=this.props.componentConfig.toJS()||{},o=i(this.context,["session","dimensions","bucket"],"");this.isHomePage=a.ui.showSearchComponent||!1;var h,p=s("Pstart(10px) Miw(200px) Bgc(t)",{"Pt(6px) Pb(10px)":this.isHomePage,"Pt(8px) Pb(8px)":!this.isHomePage,"Pos(f) Z(10) T(0) Start(0px) W(100%) Bxz(bb)":r,"Pend(62px)":!t,"Pend(10px)":t}),l=i(a,["tsrc","page","home"],"hromb"),u=i(a,["tsrc","page","content"],"content"),d={prefix:i(a,["tsrc","prefix"],"yfp"),pageSrc:this.isHomePage===!0?l:u,bucket:o};return this.state.isSearchBoxFocused&&"509"===o&&(h=c.createElement(b,{searchAssistTerms:this.state.searchAssistTerms,searchAssistMaxLength:this.state.ui.searchAssistMaxLength,showNearby:this.state.ui.showNearbyEntry,nearbyEntry:this.state.nearbyEntry,srp:this.state.srp,tsrcConfig:d,searchTerm:this.state.currentSearchTerm,searchWrapRef:this.refs.searchWrap,placeholderText:this.state.placeholderText,bucket:o,i13n:this.props.i13n,isHomePage:this.isHomePage})),c.createElement("div",{className:"Pos(r) Z(5)",ref:"searchWrap"},c.createElement("div",{id:this.props.id,className:p},c.createElement(y,{searchTerm:this.state.currentSearchTerm,searchAssistTerms:this.state.searchAssistTerms,ui:this.state.ui,srp:this.state.srp,gossip:this.state.gossip,trending:this.state.trending,popularSearch:this.state.popularSearch,tsrcConfig:d,focus:this.state.isSearchBoxFocused,searchWrapRef:this.refs&&this.refs.searchWrap,placeholderText:this.state.placeholderText,bucket:o,i13n:this.props.i13n,isHomePage:this.isHomePage,nearbyEntry:this.state.nearbyEntry}),t?null:e),r?c.createElement("div",{style:{height:n}}):null,h)},_getStoreData:function(){var e=this.getStore("SearchStore").getSearch(this.props.id);return e}});e.exports=P},1735:function(e,t,r){function s(){}function i(e,t,r){function i(){c.parentNode&&c.parentNode.removeChild(c),window[l]=s,h&&clearTimeout(h)}function o(){window[l]&&i()}"function"==typeof t&&(r=t,t={}),t||(t={});var c,h,p=t.prefix||"__jp",l=t.name||p+a++,u=t.param||"callback",d=null!=t.timeout?t.timeout:6e4,m=encodeURIComponent,f=document.getElementsByTagName("script")[0]||document.head;return d&&(h=setTimeout(function(){i(),r&&r(new Error("Timeout"))},d)),window[l]=function(e){n("jsonp got",e),i(),r&&r(null,e)},e+=(~e.indexOf("?")?"&":"?")+u+"="+m(l),e=e.replace("?&","?"),n('jsonp req "%s"',e),c=document.createElement("script"),c.src=e,f.parentNode.insertBefore(c,f),o}var n=r(1736)("jsonp");e.exports=i;var a=0},1736:function(e,t,r){function s(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var e=arguments,r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return e;var s="color: "+this.color;e=[e[0],s,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,n=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(n=i))}),e.splice(n,0,s),e}function n(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?h.removeItem("debug"):h.debug=e}catch(t){}}function o(){var e;try{e=h.debug}catch(t){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=r(1737),t.log=n,t.formatArgs=i,t.save=a,t.load=o,t.useColors=s;var h;h="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(o())},1737:[1943,1738],1738:function(e,t){function r(e){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),s=(t[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return r*p;case"days":case"day":case"d":return r*h;case"hours":case"hour":case"hrs":case"hr":case"h":return r*c;case"minutes":case"minute":case"mins":case"min":case"m":return r*o;case"seconds":case"second":case"secs":case"sec":case"s":return r*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}function s(e){return e>=h?Math.round(e/h)+"d":e>=c?Math.round(e/c)+"h":e>=o?Math.round(e/o)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return n(e,h,"day")||n(e,c,"hour")||n(e,o,"minute")||n(e,a,"second")||e+" ms"}function n(e,t,r){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var a=1e3,o=60*a,c=60*o,h=24*c,p=365.25*h;e.exports=function(e,t){return t=t||{},"string"==typeof e?r(e):t["long"]?i(e):s(e)}},1759:function(e,t){e.exports=function(e,t,r){var s=[],i=function(e){s.push(n+"="+(r?e:encodeURIComponent(e)))};for(var n in e)void 0!==e[n]&&(e[n]instanceof Array?e[n].forEach(i):s.push(n+"="+(r?e[n]:encodeURIComponent(e[n]))));return s.join(t)}}});